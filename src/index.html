<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Winch Analyzer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <div class="sheet">
    <div class="build-indicator" id="build-info" aria-live="polite"></div>
    <header class="page-header">
      <img src="assets/winch-header%20140px.png" alt="TekMarines winch diagram" class="page-header__image" />
      <h1 class="page-title">Winch Analyzer</h1>
    </header>
    <div id="err"></div>

    <nav class="tabs" aria-label="App sections">
      <button class="tab-btn active" data-target="panel-inputs">Section 1: Inputs</button>
      <button class="tab-btn" data-target="panel-performance">Section 2: Performance Plots</button>
      <button class="tab-btn" data-target="panel-results">Section 3: Layer &amp; Wrap Tables</button>
    </nav>

    <div id="panel-inputs" class="panel active">
      <details class="card collapsible" open>
        <summary class="collapsible-summary">
          <h2 class="section-title">Section 1: Drum and Cable Inputs</h2>
          <span class="collapsible-hint" aria-hidden="true"></span>
        </summary>
        <div class="collapsible-body">
          <table class="worksheet">
            <thead>
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col" class="value">Input</th>
                <th scope="col" class="units">Units</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row">
                  <label class="param-label" for="c_mm" data-code="c_mm">Cable Diameter <span class="symbol" aria-hidden="true">d<sub>c</sub></span></label>
                </th>
                <td class="value"><input id="c_mm" type="number" step="0.1" value="30"></td>
                <td class="units">mm</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="depth_m" data-code="depth_m">Operating Depth <span class="symbol" aria-hidden="true">L<sub>op</sub></span></label>
                </th>
                <td class="value"><input id="depth_m" type="number" step="1" value="3000"></td>
                <td class="units">m</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="dead_m" data-code="dead_m">Dead End Length <span class="symbol" aria-hidden="true">L<sub>dead</sub></span></label>
                </th>
                <td class="value"><input id="dead_m" type="number" step="0.1" value="100"></td>
                <td class="units">m</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="core_in" data-code="core_in">Core Diameter <span class="symbol" aria-hidden="true">d<sub>core</sub></span></label>
                </th>
                <td class="value"><input id="core_in" type="number" step="0.001" value="64"></td>
                <td class="units">in</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="ftf_in" data-code="ftf_in">Flange-to-Flange Width <span class="symbol" aria-hidden="true">w<sub>FTF</sub></span></label>
                </th>
                <td class="value"><input id="ftf_in" type="number" step="0.001" value="116"></td>
                <td class="units">in</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="lebus_in" data-code="lebus_in">Lebus Liner Thickness <span class="symbol" aria-hidden="true">t<sub>lebus</sub></span></label>
                </th>
                <td class="value"><input id="lebus_in" type="number" step="0.001" value="0.625"></td>
                <td class="units">in</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="pack" data-code="pack">Packing Factor <span class="symbol" aria-hidden="true">φ<sub>pack</sub></span></label>
                </th>
                <td class="value"><input id="pack" type="number" step="0.001" value="0.877"></td>
                <td class="units">–</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="wraps_override" data-code="wraps_override">Wraps per Layer <span class="symbol" aria-hidden="true">N<sub>wrap</sub></span></label>
                </th>
                <td class="value"><input id="wraps_override" type="number" step="0.5" placeholder="auto"></td>
                <td class="units">wraps</td>
              </tr>
              <tr class="note">
                <td colspan="3" class="dim" id="wraps_note">Leave blank or set to 0 to use calculated wraps (always truncated to .0/.5).</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="gearbox_select" data-code="gearbox_select">Gearbox Part Number</label>
                </th>
                <td class="value">
                  <select id="gearbox_select">
                    <option value="">Custom (manual input)</option>
                  </select>
                </td>
                <td class="units">–</td>
              </tr>
              <tr class="note">
                <td colspan="3" class="dim">Selecting a gearbox fills Gear Ratio 1 and Gear Ratio 2 automatically. Editing either ratio clears the selection.</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="gr1" data-code="gr1">Gear Ratio 1 <span class="symbol" aria-hidden="true">G<sub>1</sub></span></label>
                </th>
                <td class="value"><input id="gr1" type="number" step="0.1" value="20"></td>
                <td class="units">–</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="gr2" data-code="gr2">Gear Ratio 2 <span class="symbol" aria-hidden="true">G<sub>2</sub></span></label>
                </th>
                <td class="value"><input id="gr2" type="number" step="0.1" value="5"></td>
                <td class="units">–</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="motors" data-code="motors">Number of Drive Motors <span class="symbol" aria-hidden="true">N<sub>m</sub></span></label>
                </th>
                <td class="value"><input id="motors" type="number" step="1" value="6"></td>
                <td class="units">count</td>
              </tr>
              <tr class="note">
                <td colspan="3" class="dim">Used by both Electric &amp; Hydraulic for torque split and RPM mapping.</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="c_w_kgpm" data-code="c_w_kgpm">Cable Weight in Water <span class="symbol" aria-hidden="true">w<sub>c</sub></span></label>
                </th>
                <td class="value"><input id="c_w_kgpm" type="number" step="0.01" value="3.8"></td>
                <td class="units">kg/m</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="payload_kg" data-code="payload_kg">Payload in Water <span class="symbol" aria-hidden="true">W<sub>payload</sub></span></label>
                </th>
                <td class="value"><input id="payload_kg" type="number" step="1" value="8000"></td>
                <td class="units">kg</td>
              </tr>
              <tr class="note">
                <td colspan="3" class="dim">T(kgf) = payload + cable weight × deployed length (static).</td>
              </tr>
            </tbody>
          </table>
        </div>
      </details>

      

      <section class="card">
        <h2 class="section-title">Section 1: Drive Configuration</h2>
        <table class="worksheet compact">
          <thead>
            <tr>
              <th scope="col">Parameter</th>
              <th scope="col" class="value">Input</th>
              <th scope="col" class="units">Units</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">
                <span class="param-label" data-code="drive_modes">Enabled Drive Types</span>
              </th>
              <td class="value">
                <div class="toggle-group">
                  <label for="drive_electric_enabled"><input id="drive_electric_enabled" type="checkbox" checked> Electric</label>
                  <label for="drive_hydraulic_enabled"><input id="drive_hydraulic_enabled" type="checkbox" checked> Hydraulic</label>
                </div>
              </td>
              <td class="units">–</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="system_select" data-code="system_select">Predefined Winch System</label>
              </th>
              <td class="value">
                <select id="system_select">
                  <option value="">Custom (manual input)</option>
                </select>
              </td>
              <td class="units">–</td>
            </tr>
            <tr class="note">
              <td colspan="3" class="dim">Selecting a system populates drum geometry, drivetrain, and component selections automatically. Editing any populated field clears the system selection.</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="rated_speed_mpm" data-code="rated_speed_mpm">Rated Line Speed <span class="symbol" aria-hidden="true">v<sub>rated</sub></span></label>
              </th>
              <td class="value"><input id="rated_speed_mpm" type="number" step="0.1" value="30"></td>
              <td class="units">m/min</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="rated_swl_kgf" data-code="rated_swl_kgf">Safe Working Load <span class="symbol" aria-hidden="true">T<sub>SWL</sub></span></label>
              </th>
              <td class="value"><input id="rated_swl_kgf" type="number" step="1" value="8000"></td>
              <td class="units">kgf</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="system_efficiency" data-code="system_efficiency">System Efficiency <span class="symbol" aria-hidden="true">η<sub>sys</sub></span></label>
              </th>
              <td class="value"><input id="system_efficiency" type="number" step="0.01" value="0.9"></td>
              <td class="units">–</td>
            </tr>
            <tr>
              <th scope="row">Minimum System Horsepower</th>
              <td class="value"><span id="system_min_hp" class="output-field">–</span></td>
              <td class="units">hp</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section class="card" data-drive-scope="electric">
        <h2 class="section-title">Section 1: Electric Inputs</h2>
        <table class="worksheet">
          <thead>
            <tr>
              <th scope="col">Parameter</th>
              <th scope="col" class="value">Input</th>
              <th scope="col" class="units">Units</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">
                <label class="param-label" for="electric_motor_select" data-code="electric_motor_select">Electric Motor Part Number</label>
              </th>
              <td class="value">
                <select id="electric_motor_select">
                  <option value="">Custom (manual input)</option>
                </select>
              </td>
              <td class="units">–</td>
            </tr>
            <tr class="note">
              <td colspan="3" class="dim">Selecting a motor fills the maximum speed, rated power, and maximum torque inputs automatically. Adjusting any of those values clears the selection.</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="motor_max_rpm" data-code="motor_max_rpm">Motor Maximum Speed <span class="symbol" aria-hidden="true">ω<sub>m,max</sub></span></label>
              </th>
              <td class="value"><input id="motor_max_rpm" type="number" step="1" value="1800"></td>
              <td class="units">rpm</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="motor_hp" data-code="motor_hp">Motor Rated Power <span class="symbol" aria-hidden="true">P<sub>m</sub></span></label>
              </th>
              <td class="value"><input id="motor_hp" type="number" step="0.1" value="150"></td>
              <td class="units">hp</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="motor_tmax" data-code="motor_tmax">Motor Maximum Torque <span class="symbol" aria-hidden="true">τ<sub>m,max</sub></span></label>
              </th>
              <td class="value"><input id="motor_tmax" type="number" step="0.1" value="230"></td>
              <td class="units">N·m</td>
            </tr>
            <tr class="note">
              <td colspan="3" class="dim">Per-wrap: required tension → drum torque → per-motor torque. RPM limited by hp and capped by max RPM. Line speed from drum dia &amp; ratios. Available tension from motor torque cap.</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section class="card" data-drive-scope="hydraulic">
        <h2 class="section-title">Section 1: Hydraulic Inputs</h2>
        <table class="worksheet">
          <thead>
            <tr>
              <th scope="col">Parameter</th>
              <th scope="col" class="value">Input</th>
              <th scope="col" class="units">Units</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th scope="row">
                <label class="param-label" for="h_pump_strings" data-code="h_pump_strings">Number of Pump Strings <span class="symbol" aria-hidden="true">N<sub>p</sub></span></label>
              </th>
              <td class="value"><input id="h_pump_strings" type="number" step="1" value="2"></td>
              <td class="units">count</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="h_emotor_hp" data-code="h_emotor_hp">Electric Motor Nameplate Power per String <span class="symbol" aria-hidden="true">P<sub>e,str</sub></span></label>
              </th>
              <td class="value"><input id="h_emotor_hp" type="number" step="0.1" value="75"></td>
              <td class="units">hp</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="h_emotor_eff" data-code="h_emotor_eff">Electro-hydraulic Efficiency <span class="symbol" aria-hidden="true">η<sub>eh</sub></span></label>
              </th>
              <td class="value"><input id="h_emotor_eff" type="number" step="0.01" value="0.85"></td>
              <td class="units">–</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="h_emotor_rpm" data-code="h_emotor_rpm">Electric Motor Speed <span class="symbol" aria-hidden="true">ω<sub>e</sub></span></label>
              </th>
              <td class="value"><input id="h_emotor_rpm" type="number" step="1" value="1780"></td>
              <td class="units">rpm</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="hydraulic_pump_select" data-code="hydraulic_pump_select">Hydraulic Pump Part Number</label>
              </th>
              <td class="value">
                <select id="hydraulic_pump_select">
                  <option value="">Custom (manual input)</option>
                </select>
              </td>
              <td class="units">–</td>
            </tr>
            <tr class="note">
              <td colspan="3" class="dim">Selecting a pump fills the displacement and maximum pressure inputs automatically. Editing either value clears the selection.</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="h_pump_cc" data-code="h_pump_cc">Pump Displacement <span class="symbol" aria-hidden="true">q<sub>pump</sub></span></label>
              </th>
              <td class="value"><input id="h_pump_cc" type="number" step="0.1" value="210"></td>
              <td class="units">cc/rev</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="h_max_psi" data-code="h_max_psi">System Maximum Pressure <span class="symbol" aria-hidden="true">P<sub>max</sub></span></label>
              </th>
              <td class="value"><input id="h_max_psi" type="number" step="1" value="3500"></td>
              <td class="units">psi</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="hydraulic_motor_select" data-code="hydraulic_motor_select">Hydraulic Motor Part Number</label>
              </th>
              <td class="value">
                <select id="hydraulic_motor_select">
                  <option value="">Custom (manual input)</option>
                </select>
              </td>
              <td class="units">–</td>
            </tr>
            <tr class="note">
              <td colspan="3" class="dim">Selecting a motor fills the hydraulic motor displacement and maximum speed inputs automatically. Adjusting either value clears the selection.</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="h_hmot_cc" data-code="h_hmot_cc">Hydraulic Motor Displacement <span class="symbol" aria-hidden="true">q<sub>hm</sub></span></label>
              </th>
              <td class="value"><input id="h_hmot_cc" type="number" step="0.1" value="55"></td>
              <td class="units">cc/rev</td>
            </tr>
            <tr>
              <th scope="row">
                <label class="param-label" for="h_hmot_rpm_max" data-code="h_hmot_rpm_max">Hydraulic Motor Maximum Speed <span class="symbol" aria-hidden="true">ω<sub>hm,max</sub></span></label>
              </th>
              <td class="value"><input id="h_hmot_rpm_max" type="number" step="1" value="3500"></td>
              <td class="units">rpm</td>
            </tr>
          </tbody>
        </table>
      </section>
    </div>

    <div id="panel-performance" class="panel">
      <section class="card wave-card">
        <div class="card-header">
          <h2 class="section-title">Section 2: Wave Contours</h2>
          <div class="btnbar card-header-actions">
            <button id="wave_redraw" type="button">Redraw contours</button>
          </div>
        </div>
        <div class="plot-controls">
          <div class="plot-controls__group">
            <div class="plot-controls__group-title">Scenario</div>
            <table class="worksheet compact plot-controls__table">
              <tbody>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="wave_scenario" data-code="wave_scenario">Wave Scenario <span class="symbol" aria-hidden="true">S<sub>w</sub></span></label>
                  </th>
                  <td class="value">
                    <select id="wave_scenario">
                      <option value="electric" selected>Electric</option>
                      <option value="hydraulic">Hydraulic</option>
                    </select>
                  </td>
                  <td class="units">–</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="plot-controls__group">
            <div class="plot-controls__group-title">Period axis (both plots)</div>
            <table class="worksheet compact plot-controls__table">
              <tbody>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="wave_tmin" data-code="wave_tmin">Minimum Wave Period <span class="symbol" aria-hidden="true">T<sub>min</sub></span></label>
                  </th>
                  <td class="value"><input id="wave_tmin" type="number" step="0.1" min="0" value="4"></td>
                  <td class="units">s</td>
                </tr>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="wave_tmax" data-code="wave_tmax">Maximum Wave Period <span class="symbol" aria-hidden="true">T<sub>max</sub></span></label>
                  </th>
                  <td class="value"><input id="wave_tmax" type="number" step="0.1" min="0" value="20"></td>
                  <td class="units">s</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="plot-controls__group">
            <div class="plot-controls__group-title">Speed axis (speed plot)</div>
            <table class="worksheet compact plot-controls__table">
              <tbody>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="wave_vmin" data-code="wave_vmin">Minimum Contour Speed <span class="symbol" aria-hidden="true">v<sub>min</sub></span></label>
                  </th>
                  <td class="value"><input id="wave_vmin" type="number" step="0.1" min="0" value="0"></td>
                  <td class="units">m/s</td>
                </tr>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="wave_vmax" data-code="wave_vmax">Maximum Contour Speed <span class="symbol" aria-hidden="true">v<sub>max</sub></span></label>
                  </th>
                  <td class="value"><input id="wave_vmax" type="number" step="0.1" min="0" placeholder="auto"></td>
                  <td class="units">m/s</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="plot-controls__group">
            <div class="plot-controls__group-title">Height axis (height plot)</div>
            <table class="worksheet compact plot-controls__table">
              <tbody>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="wave_hmin" data-code="wave_hmin">Minimum Wave Height <span class="symbol" aria-hidden="true">H<sub>min</sub></span></label>
                  </th>
                  <td class="value"><input id="wave_hmin" type="number" step="0.1" min="0" value="0"></td>
                  <td class="units">m</td>
                </tr>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="wave_hmax" data-code="wave_hmax">Maximum Wave Height <span class="symbol" aria-hidden="true">H<sub>max</sub></span></label>
                  </th>
                  <td class="value"><input id="wave_hmax" type="number" step="0.1" min="0" value="6"></td>
                  <td class="units">m</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="twocol waveplots">
          <div class="col plot-column">
            <div class="plot-panel">
              <div class="plot-panel__heading">
                <div>
                  <div class="plot-title">Speed vs Period with Height Lines</div>
                  <div class="dim">Contours: v(T) = π·H / T. Black solid = whole meters; black dashed = half meters. Gray horizontals = layer speeds (selected scenario).</div>
                </div>
                <button type="button" class="plot-panel__toggle" data-plot-toggle aria-expanded="false">[+]</button>
              </div>
              <div class="plotwrap">
                <svg id="wave_svg" width="1000" height="540" viewBox="0 0 1000 540"></svg>
              </div>
              <div class="legend">
                <div class="legitem"><span class="swatch"></span><span>H = integer m</span></div>
                <div class="legitem"><span class="swatch dashed"></span><span>H = 0.5 m offsets</span></div>
                <div class="legitem"><span class="swatch gray"></span><span>Layer speed (scenario)</span></div>
              </div>
            </div>
          </div>
          <div class="col plot-column">
            <div class="plot-panel">
              <div class="plot-panel__heading">
                <div>
                  <div class="plot-title">Wave Height vs Period with Speed Lines</div>
                  <div class="dim">Contours: H(T) = v·T / π for each layer speed. Solid/dashed horizontals = reference wave heights.</div>
                </div>
                <button type="button" class="plot-panel__toggle" data-plot-toggle aria-expanded="false">[+]</button>
              </div>
              <div class="plotwrap">
                <svg id="wave_svg_height" width="1000" height="540" viewBox="0 0 1000 540"></svg>
              </div>
              <div class="legend">
                <div class="legitem"><span class="swatch gray"></span><span>Layer speed iso-line</span></div>
                <div class="legitem"><span class="swatch"></span><span>H = integer m</span></div>
                <div class="legitem"><span class="swatch dashed"></span><span>H = 0.5 m offsets</span></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="card">
        <div class="card-header">
          <h2 class="section-title">Section 2: Depth Profiles</h2>
          <div class="btnbar card-header-actions">
            <button id="depth_redraw" type="button">Redraw profiles</button>
          </div>
        </div>
        <div class="plot-controls">
          <div class="plot-controls__group">
            <div class="plot-controls__group-title">Scenario &amp; references</div>
            <table class="worksheet compact plot-controls__table">
              <tbody>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="depth_scenario" data-code="depth_scenario">Profile Scenario <span class="symbol" aria-hidden="true">S<sub>d</sub></span></label>
                  </th>
                  <td class="value">
                    <select id="depth_scenario">
                      <option value="electric" selected>Electric (start-of-layer values)</option>
                      <option value="hydraulic">Hydraulic (start-of-layer values)</option>
                    </select>
                  </td>
                  <td class="units">–</td>
                </tr>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="depth_rated_speed_ms" data-code="depth_rated_speed_ms">Rated Speed <span class="symbol" aria-hidden="true">v<sub>rated</sub></span></label>
                  </th>
                  <td class="value"><input id="depth_rated_speed_ms" type="number" step="0.01" min="0" value="1"></td>
                  <td class="units">m/s</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="plot-controls__group">
            <div class="plot-controls__group-title">Depth axis (both plots)</div>
            <table class="worksheet compact plot-controls__table">
              <tbody>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="depth_xmin" data-code="depth_xmin">Minimum Depth <span class="symbol" aria-hidden="true">d<sub>min</sub></span></label>
                  </th>
                  <td class="value"><input id="depth_xmin" type="number" step="1" min="0" value="0"></td>
                  <td class="units">m</td>
                </tr>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="depth_xmax" data-code="depth_xmax">Maximum Depth <span class="symbol" aria-hidden="true">d<sub>max</sub></span></label>
                  </th>
                  <td class="value"><input id="depth_xmax" type="number" step="1" min="0" placeholder="auto"></td>
                  <td class="units">m</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="plot-controls__group">
            <div class="plot-controls__group-title">Speed axis</div>
            <table class="worksheet compact plot-controls__table">
              <tbody>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="depth_speed_ymin" data-code="depth_speed_ymin">Minimum Speed <span class="symbol" aria-hidden="true">v<sub>min</sub></span></label>
                  </th>
                  <td class="value"><input id="depth_speed_ymin" type="number" step="0.01" min="0" value="0"></td>
                  <td class="units">m/s</td>
                </tr>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="depth_speed_ymax" data-code="depth_speed_ymax">Maximum Speed <span class="symbol" aria-hidden="true">v<sub>max</sub></span></label>
                  </th>
                  <td class="value"><input id="depth_speed_ymax" type="number" step="0.01" min="0" placeholder="auto"></td>
                  <td class="units">m/s</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="plot-controls__group">
            <div class="plot-controls__group-title">Tension axis</div>
            <table class="worksheet compact plot-controls__table">
              <tbody>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="depth_tension_ymin" data-code="depth_tension_ymin">Minimum Tension <span class="symbol" aria-hidden="true">T<sub>min</sub></span></label>
                  </th>
                  <td class="value"><input id="depth_tension_ymin" type="number" step="1" min="0" value="0"></td>
                  <td class="units">kgf</td>
                </tr>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="depth_tension_ymax" data-code="depth_tension_ymax">Maximum Tension <span class="symbol" aria-hidden="true">T<sub>max</sub></span></label>
                  </th>
                  <td class="value"><input id="depth_tension_ymax" type="number" step="1" min="0" placeholder="auto"></td>
                  <td class="units">kgf</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="twocol depth-plots">
          <div class="col plot-column">
            <div class="plot-panel">
              <div class="plot-panel__heading">
                <div class="plot-title">Available Speed vs Depth</div>
                <button type="button" class="plot-panel__toggle" data-plot-toggle aria-expanded="false">[+]</button>
              </div>
              <div class="plotwrap">
                <svg id="depth_speed_svg" viewBox="0 0 1000 540"></svg>
              </div>
              <div class="legend legend--compact">
                <div class="legitem"><span class="swatch accent"></span><span>Available speed</span></div>
                <div class="legitem"><span class="swatch rated"></span><span>Rated speed</span></div>
                <div class="legitem"><span class="swatch light dashed"></span><span>Candidate speeds (V<sub>p</sub>, V<sub>Q</sub>)</span></div>
              </div>
            </div>
          </div>
          <div class="col plot-column">
            <div class="plot-panel">
              <div class="plot-panel__heading">
                <div class="plot-title">Tension vs Depth</div>
                <button type="button" class="plot-panel__toggle" data-plot-toggle aria-expanded="false">[+]</button>
              </div>
              <div class="plotwrap">
                <svg id="depth_tension_svg" viewBox="0 0 1000 540"></svg>
              </div>
              <div class="legend legend--compact">
                <div class="legitem"><span class="swatch theoretical"></span><span>Theoretical tension</span></div>
                <div class="legitem"><span class="swatch accent"></span><span>Required tension (with safety factor)</span></div>
                <div class="legitem"><span class="swatch accent dashed"></span><span>Available tension</span></div>
                <div class="legitem"><span class="swatch red"></span><span>Required above available</span></div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>

    <div id="panel-results" class="panel">
      <div class="card" id="drum_card">
        <div class="section-title">Section 3: Drum Visualization</div>
        <div class="drum-visual">
          <svg
            id="drum_visual_svg"
            class="drum-visual__svg"
            viewBox="0 0 320 320"
            role="img"
            aria-labelledby="drum_visual_title"
          >
            <title id="drum_visual_title">Winch drum cross-section</title>
          </svg>
        </div>
        <p class="drum-summary" id="drum_summary"></p>
      </div>

      <div class="card" data-drive-scope="electric">
        <div class="section-title">Section 3: Electric Layer Table</div>
        <div class="btnbar">
          <button id="csv_el_layer" type="button" disabled>Download CSV — Electric Layer</button>
        </div>
        <table>
          <thead>
            <tr>
              <th title="layer_no">L#<br>(–)</th>
              <th title="layer_dia_in">D<sub>layer</sub><br>(in)</th>
              <th title="pre_on_drum_m">pre_on<br>(m)</th>
              <th title="pre_deployed_m">pre_dep<br>(m)</th>
              <th title="post_on_drum_m">post_on<br>(m)</th>
              <th title="post_deployed_m">post_dep<br>(m)</th>
              <th title="max_tension_theoretical_kgf">T<sub>theo,max</sub><br>(kgf)</th>
              <th title="max_tension_required_kgf">T<sub>req,max</sub><br>(kgf)</th>
              <th title="max_torque_Nm">τ<sub>max</sub><br>(N·m)</th>
              <th title="max_motor_torque_Nm">τ<sub>m,max</sub><br>(N·m)</th>
              <th title="motor_rpm_at_start">n<sub>m,start</sub><br>(rpm)</th>
              <th title="line_speed_at_start_mpm">v<sub>start</sub><br>(m/min)</th>
              <th title="avail_tension_kgf_at_start">T<sub>avail,start</sub><br>(kgf)</th>
            </tr>
          </thead>
          <tbody id="tbody_el_layer"></tbody>
        </table>
      </div>

      <details class="card collapsible" data-drive-scope="electric">
        <summary class="collapsible-summary">
          <span class="section-title">Section 3: Electric Wraps Table</span>
          <span class="collapsible-hint" aria-hidden="true"></span>
        </summary>
        <div class="collapsible-body">
          <div class="btnbar">
            <button id="csv_el_wraps" type="button" disabled>Download CSV — Electric Wraps</button>
          </div>
          <table>
            <thead>
              <tr>
                <th title="wrap_no">W#<br>(–)</th>
                <th title="layer_no">L#<br>(–)</th>
                <th title="layer_dia_in">D<sub>layer</sub><br>(in)</th>
                <th title="wrap_len_in">L<sub>wrap</sub><br>(in)</th>
                <th title="pre_spooled_len_m">pre_spool<br>(m)</th>
                <th title="spooled_len_m">on_drum<br>(m)</th>
                <th title="deployed_len_m">dep<br>(m)</th>
                <th title="tension_theoretical_kgf">T<sub>theo</sub><br>(kgf)</th>
                <th title="tension_required_kgf">T<sub>req</sub><br>(kgf)</th>
                <th title="torque_Nm">τ<br>(N·m)</th>
                <th title="motor_torque_Nm">τ<sub>m</sub><br>(N·m)</th>
                <th title="motor_rpm">n<sub>m</sub><br>(rpm)</th>
                <th title="line_speed_mpm">v<br>(m/min)</th>
                <th title="avail_tension_kgf">T<sub>avail</sub><br>(kgf)</th>
              </tr>
            </thead>
            <tbody id="tbody_el_wraps"></tbody>
          </table>
        </div>
      </details>

      <div class="card" data-drive-scope="hydraulic">
        <div class="section-title">Section 3: Hydraulic Layer Table</div>
        <div class="btnbar">
          <button id="csv_hy_layer" type="button" disabled>Download CSV — Hydraulic Layer</button>
        </div>
        <table>
          <thead>
            <tr>
              <th title="layer_no">L#<br>(–)</th>
              <th title="layer_dia_in">D<sub>layer</sub><br>(in)</th>
              <th title="pre_on_drum_m">pre_on<br>(m)</th>
              <th title="pre_deployed_m">pre_dep<br>(m)</th>
              <th title="post_on_drum_m">post_on<br>(m)</th>
              <th title="post_deployed_m">post_dep<br>(m)</th>
              <th title="hyd_P_required_psi">P<sub>req</sub><br>(psi)</th>
              <th title="hyd_speed_power_mpm">v<sub>P</sub><br>(m/min)</th>
              <th title="hyd_speed_flow_mpm">v<sub>Q</sub><br>(m/min)</th>
              <th title="hyd_speed_available_mpm">v<sub>avail</sub><br>(m/min)</th>
              <th title="hyd_hp_used_at_available">HP<sub>hyd_used</sub><br>(hp)</th>
              <th title="hyd_elec_input_hp_used">HP<sub>elec_in</sub><br>(hp)</th>
              <th title="hyd_drum_torque_at_maxP_Nm">τ<sub>drum@Pmax</sub><br>(N·m)</th>
              <th title="hyd_avail_tension_kgf_at_start">T<sub>avail,start</sub><br>(kgf)</th>
            </tr>
          </thead>
          <tbody id="tbody_hy_layer"></tbody>
        </table>
      </div>

      <details class="card collapsible" data-drive-scope="hydraulic">
        <summary class="collapsible-summary">
          <span class="section-title">Section 3: Hydraulic Wraps Table</span>
          <span class="collapsible-hint" aria-hidden="true"></span>
        </summary>
        <div class="collapsible-body">
          <div class="btnbar">
            <button id="csv_hy_wraps" type="button" disabled>Download CSV — Hydraulic Wraps</button>
          </div>
          <table>
            <thead>
              <tr>
                <th title="wrap_no">W#<br>(–)</th>
                <th title="layer_no">L#<br>(–)</th>
                <th title="layer_dia_in">D<sub>layer</sub><br>(in)</th>
                <th title="wrap_len_in">L<sub>wrap</sub><br>(in)</th>
                <th title="pre_spooled_len_m">pre_spool<br>(m)</th>
                <th title="spooled_len_m">on_drum<br>(m)</th>
                <th title="deployed_len_m">dep<br>(m)</th>
                <th title="tension_theoretical_kgf">T<sub>theo</sub><br>(kgf)</th>
                <th title="tension_required_kgf">T<sub>req</sub><br>(kgf)</th>
                <th title="hyd_P_required_psi">P<sub>req</sub><br>(psi)</th>
                <th title="hyd_speed_power_mpm">v<sub>P</sub><br>(m/min)</th>
                <th title="hyd_speed_flow_mpm">v<sub>Q</sub><br>(m/min)</th>
                <th title="hyd_speed_available_mpm">v<sub>avail</sub><br>(m/min)</th>
                <th title="hyd_hp_used_at_available">HP<sub>hyd_used</sub><br>(hp)</th>
                <th title="hyd_elec_input_hp_used">HP<sub>elec_in</sub><br>(hp)</th>
                <th title="hyd_drum_torque_maxP_Nm">τ<sub>drum@Pmax</sub><br>(N·m)</th>
                <th title="hyd_avail_tension_kgf">T<sub>avail</sub><br>(kgf)</th>
              </tr>
            </thead>
            <tbody id="tbody_hy_wraps"></tbody>
          </table>
        </div>
      </details>
    </div>

    <!-- Main app script -->
    <script type="module" src="js/main.mjs"></script>
  </div>
</body>
</html>
