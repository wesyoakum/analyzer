<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Winch Analysis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="css/styles.css" />
  <!-- KaTeX setup -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css"
  />
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"
  ></script>
  <script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"
  ></script>
</head>
<body>
  <div class="app-shell">
    <aside class="app-sidebar">
      <div class="app-sidebar__header">
        <div>
          <h2 class="app-sidebar__title">Winch configuration</h2>
          <div class="project-controls" aria-label="Project controls">
            <div class="project-controls__row">
              <label class="sr-only" for="project_select">Saved projects</label>
              <select id="project_select" aria-label="Saved projects">
                <option value="">Saved projects</option>
              </select>
              <button id="load_project" class="app-sidebar__action app-sidebar__action--button" type="button">Load</button>
              <button id="delete_project" class="app-sidebar__action app-sidebar__action--button" type="button">Delete</button>
            </div>
            <div class="project-controls__row">
              <label class="sr-only" for="project_name">Project name</label>
              <input id="project_name" type="text" placeholder="Project name" aria-label="Project name">
              <button id="save_project_new" class="app-sidebar__action app-sidebar__action--button" type="button">Save new</button>
              <button id="save_project" class="app-sidebar__action app-sidebar__action--button" type="button">Update</button>
              <button id="rename_project" class="app-sidebar__action app-sidebar__action--button" type="button">Rename</button>
              <button id="clear_inputs" class="app-sidebar__action app-sidebar__action--button" type="button">Clear inputs</button>
            </div>
            <p id="project_status" class="project-controls__status" role="status" aria-live="polite"></p>
          </div>
        </div>
      </div>
      <div class="report-toolbar" aria-label="Application status">
        <div class="report-toolbar__status">
          <div class="build-indicator" id="build-info" aria-live="polite"></div>
        </div>
      </div>
      <div class="app-sidebar__content" id="sidebar-inputs">
        <section class="card" data-summary-card>
          <h2 class="section-title">Section 1.1: System Inputs</h2>
            <div class="input-sections">
              <section class="input-section">
                <h3 class="input-section__title">System</h3>
                <table class="worksheet">
                  <thead>
                    <tr>
                      <th scope="col">Parameter</th>
                      <th scope="col" class="value">Input</th>
                      <th scope="col" class="units">Units</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th scope="row">
                        <label class="param-label" for="system_select" data-code="system_select">Predefined Winch System</label>
                      </th>
                      <td class="value">
                        <select id="system_select">
                          <option value="">Custom (manual input)</option>
                        </select>
                      </td>
                      <td class="units">–</td>
                    </tr>
                    <tr>
                      <th scope="row">
                        <label class="param-label" for="system_type_select" data-code="system_type">System Type</label>
                      </th>
                      <td class="value">
                        <select id="system_type_select">
                          <option value="electric">Electric</option>
                          <option value="hydraulic">Hydraulic</option>
                        </select>
                      </td>
                      <td class="units">–</td>
                    </tr>
                    <tr>
                      <th scope="row">
                        <label class="param-label" for="winch_type_select" data-code="winch_type">Winch Type</label>
                      </th>
                      <td class="value">
                        <select id="winch_type_select">
                          <option value="conventional">Conventional</option>
                          <option value="traction">Traction</option>
                        </select>
                      </td>
                      <td class="units">–</td>
                    </tr>
                  </tbody>
                </table>
              </section>
    
          <section class="input-section">
            <h3 class="input-section__title">Design</h3>
            <table class="worksheet">
              <thead>
                <tr>
                  <th scope="col">Parameter</th>
                  <th scope="col" class="value">Input</th>
                  <th scope="col" class="units">Units</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="rated_swl_kgf" data-code="rated_swl_kgf">Safe Working Load <span class="symbol" aria-hidden="true" data-latex="T_{\mathrm{SWL}}">T<sub>SWL</sub></span></label>
                  </th>
                  <td class="value"><input id="rated_swl_kgf" type="number" step="500" value="8000"></td>
                  <td class="units">kgf</td>
                </tr>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="rated_speed_mpm" data-code="rated_speed_mpm">Rated Line Speed <span class="symbol" aria-hidden="true" data-latex="v_{\mathrm{rated}}">v<sub>rated</sub></span></label>
                  </th>
                  <td class="value"><input id="rated_speed_mpm" type="number" step="1" value="30"></td>
                  <td class="units">m/min</td>
                </tr>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="system_efficiency" data-code="system_efficiency">System Efficiency <span class="symbol" aria-hidden="true" data-latex="\eta_{sys}">η<sub>sys</sub></span></label>
                  </th>
                  <td class="value"><input id="system_efficiency" type="number" step="0.1" value="0.9"></td>
                  <td class="units">–</td>
                </tr>
                <tr>
                  <th scope="row">Minimum System Horsepower</th>
                  <td class="value"><span id="system_min_hp" class="output-field">–</span></td>
                  <td class="units">hp</td>
                </tr>
              </tbody>
            </table>
          </section>
    
          <section class="input-section">
            <h3 class="input-section__title">Drum &amp; Cable</h3>
            <section class="input-subsection">
              <h4 class="input-subsection__title">Cable</h4>
              <table class="worksheet">
                <thead>
                  <tr>
                    <th scope="col">Parameter</th>
                    <th scope="col" class="value">Input</th>
                    <th scope="col" class="units">Units</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="cable_select" data-code="cable_select">Cable Part Number</label>
                    </th>
                    <td class="value">
                      <select id="cable_select">
                        <option value="">Custom (manual input)</option>
                      </select>
                    </td>
                    <td class="units">–</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="c_mm" data-code="c_mm">Cable Diameter <span class="symbol" aria-hidden="true" data-latex="d_{c}">d<sub>c</sub></span></label>
                    </th>
                    <td class="value"><input id="c_mm" type="number" step="1" value="30"></td>
                    <td class="units">mm</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="cable_len_m" data-code="cable_len_m">Cable Length <span class="symbol" aria-hidden="true" data-latex="L_{c}">L<sub>c</sub></span></label>
                    </th>
                    <td class="value"><input id="cable_len_m" type="number" step="100" value="3100"></td>
                    <td class="units">m</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="depth_m" data-code="depth_m">Max Operating Depth <span class="symbol" aria-hidden="true" data-latex="L_{op,max}">L<sub>op,max</sub></span></label>
                    </th>
                    <td class="value"><input id="depth_m" type="number" step="100" value="3000"></td>
                    <td class="units">m</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="dead_m" data-code="dead_m">Dead End Length <span class="symbol" aria-hidden="true" data-latex="L_{dead}">L<sub>dead</sub></span></label>
                    </th>
                    <td class="value"><input id="dead_m" type="number" step="100" value="100" readonly></td>
                    <td class="units">m</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="c_w_kgpm" data-code="c_w_kgpm">Cable Weight in Water <span class="symbol" aria-hidden="true" data-latex="w_{c}">w<sub>c</sub></span></label>
                    </th>
                    <td class="value"><input id="c_w_kgpm" type="number" step="0.1" value="3.8"></td>
                    <td class="units">kg/m</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="mbl_kgf" data-code="mbl_kgf">Minimum Breaking Load <span class="symbol" aria-hidden="true" data-latex="MBL">MBL</span></label>
                    </th>
                    <td class="value"><input id="mbl_kgf" type="number" step="100" min="0" value="80000"></td>
                    <td class="units">kgf</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="safety_factor" data-code="safety_factor">Safety Factor <span class="symbol" aria-hidden="true" data-latex="SF">SF</span></label>
                    </th>
                    <td class="value"><input id="safety_factor" type="number" step="0.1" min="0" value="5"></td>
                    <td class="units">–</td>
                  </tr>
                  <tr>
                    <th scope="row">Strength-Only Max Length</th>
                    <td class="value"><span id="max_length_strength_m" class="output-field">–</span></td>
                    <td class="units">m</td>
                  </tr>
                </tbody>
              </table>
              <p class="note"><span class="math" data-latex="L_{\max}=\dfrac{(MBL/SF)-W_{\mathrm{pay,sub}}}{w_{c,\mathrm{sub}}}"></span>.</p>
            </section>
    
            <section class="input-subsection">
              <h4 class="input-subsection__title">Drum</h4>
              <table class="worksheet">
                <thead>
                  <tr>
                    <th scope="col">Parameter</th>
                    <th scope="col" class="value">Input</th>
                    <th scope="col" class="units">Units</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="drum_select" data-code="drum_select">Drum Part Number</label>
                    </th>
                    <td class="value">
                      <select id="drum_select">
                        <option value="">Custom (manual input)</option>
                      </select>
                    </td>
                    <td class="units">–</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="core_in" data-code="core_in">Core Diameter <span class="symbol" aria-hidden="true" data-latex="d_{\mathrm{core}}">d<sub>core</sub></span></label>
                    </th>
                    <td class="value"><input id="core_in" type="number" step="0.5" value="64"></td>
                    <td class="units">in</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="flange_dia_in" data-code="flange_dia_in">Flange Diameter <span class="symbol" aria-hidden="true" data-latex="d_{\mathrm{flange}}">d<sub>flange</sub></span></label>
                    </th>
                    <td class="value"><input id="flange_dia_in" type="number" step="0.5" value="110"></td>
                    <td class="units">in</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="ftf_in" data-code="ftf_in">Flange-to-Flange Width <span class="symbol" aria-hidden="true" data-latex="w_{\mathrm{FTF}}">w<sub>FTF</sub></span></label>
                    </th>
                    <td class="value"><input id="ftf_in" type="number" step="0.5" value="116"></td>
                    <td class="units">in</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="lebus_in" data-code="lebus_in">Lebus Liner Thickness <span class="symbol" aria-hidden="true" data-latex="t_{\mathrm{lebus}}">t<sub>lebus</sub></span></label>
                    </th>
                    <td class="value"><input id="lebus_in" type="number" step="0.1" value="0.625"></td>
                    <td class="units">in</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="pack" data-code="pack">Packing Factor <span class="symbol" aria-hidden="true" data-latex="\phi_{\mathrm{pack}}">φ<sub>pack</sub></span></label>
                    </th>
                    <td class="value"><input id="pack" type="number" step="0.1" value="0.877"></td>
                    <td class="units">–</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="wraps_override" data-code="wraps_override">Wraps per Layer <span class="symbol" aria-hidden="true" data-latex="N_{wrap}">N<sub>wrap</sub></span></label>
                    </th>
                    <td class="value"><input id="wraps_override" type="number" step="0.5" placeholder="auto"></td>
                    <td class="units">wraps</td>
                  </tr>
                  <tr class="note">
                    <td colspan="3" class="dim" id="wraps_note">Leave blank to use calculated wraps.</td>
                  </tr>
                </tbody>
              </table>
            </section>
          </section>
    
          <section class="input-section">
            <h3 class="input-section__title">Payload</h3>
            <table class="worksheet">
              <thead>
                <tr>
                  <th scope="col">Parameter</th>
                  <th scope="col" class="value">Input</th>
                  <th scope="col" class="units">Units</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="payload_select" data-code="payload_select">Payload Part Number</label>
                  </th>
                  <td class="value">
                    <select id="payload_select">
                      <option value="">Custom (manual input)</option>
                    </select>
                  </td>
                  <td class="units">–</td>
                </tr>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="payload_kg" data-code="payload_kg">Payload in Water <span class="symbol" aria-hidden="true" data-latex="W_{\mathrm{payload}}">W<sub>payload</sub></span></label>
                  </th>
                  <td class="value"><input id="payload_kg" type="number" step="100" value="8000"></td>
                  <td class="units">kg</td>
                </tr>
                <tr class="note">
                  <td colspan="3" class="dim">T(kgf) = payload + cable weight × deployed length (static).</td>
                </tr>
              </tbody>
            </table>
          </section>
    
          <section class="input-section">
            <h3 class="input-section__title">Drivetrain</h3>
            <table class="worksheet">
              <thead>
                <tr>
                  <th scope="col">Parameter</th>
                  <th scope="col" class="value">Input</th>
                  <th scope="col" class="units">Units</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">
                    <label class="param-label" for="motors" data-code="motors">Number of Drive Motors <span class="symbol" aria-hidden="true" data-latex="N_{m}">N<sub>m</sub></span></label>
                  </th>
                  <td class="value"><input id="motors" type="number" step="1" value="6"></td>
                  <td class="units">count</td>
                </tr>
              </tbody>
            </table>
    
            <section class="input-subsection">
              <h4 class="input-subsection__title">Gearbox</h4>
              <table class="worksheet">
                <thead>
                  <tr>
                    <th scope="col">Parameter</th>
                    <th scope="col" class="value">Input</th>
                    <th scope="col" class="units">Units</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="gearbox_select" data-code="gearbox_select">Gearbox Part Number</label>
                    </th>
                    <td class="value">
                      <select id="gearbox_select">
                        <option value="">Custom (manual input)</option>
                      </select>
                    </td>
                    <td class="units">–</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="gr1" data-code="gr1">Gear Ratio 1 <span class="symbol" aria-hidden="true" data-latex="G_{1}">G<sub>1</sub></span></label>
                    </th>
                    <td class="value"><input id="gr1" type="number" step="1" value="20"></td>
                    <td class="units">–</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="gr2" data-code="gr2">Gear Ratio 2 <span class="symbol" aria-hidden="true" data-latex="G_{2}">G<sub>2</sub></span></label>
                    </th>
                    <td class="value"><input id="gr2" type="number" step="1" value="5"></td>
                    <td class="units">–</td>
                  </tr>
                  <tr>
                    <th scope="row">
                      <label class="param-label" for="gearbox_max_torque_Nm" data-code="gearbox_max_torque_Nm">Gearbox Maximum Torque <span class="symbol" aria-hidden="true" data-latex="\tau_{g,\max}">τ<sub>g,max</sub></span></label>
                    </th>
                    <td class="value"><input id="gearbox_max_torque_Nm" type="number" step="100" placeholder="enter"></td>
                    <td class="units">N·m</td>
                  </tr>
                </tbody>
              </table>
            </section>
          </section>
        </div>
      </div>
    </section>
    
    
    
    
    <section class="card" data-drive-scope="electric" data-summary-card>
      <h2 class="section-title">Section 1.2: Electric Inputs</h2>
      <table class="worksheet">
        <thead>
          <tr>
            <th scope="col">Parameter</th>
            <th scope="col" class="value">Input</th>
            <th scope="col" class="units">Units</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th scope="row">
              <label class="param-label" for="motor_eff" data-code="motor_eff">Electro-Mechanical Efficiency <span class="symbol" aria-hidden="true" data-latex="\eta_{em}">η<sub>em</sub></span></label>
            </th>
            <td class="value"><input id="motor_eff" type="number" step=".1" value="0.95"></td>
            <td class="units">–</td>
          </tr>
          <tr>
            <th scope="row">
              <label class="param-label" for="electric_motor_select" data-code="electric_motor_select">Electric Motor Part Number</label>
            </th>
            <td class="value">
              <select id="electric_motor_select">
                <option value="">Custom (manual input)</option>
              </select>
            </td>
            <td class="units">–</td>
          </tr>
          <tr>
            <th scope="row">
              <label class="param-label" for="motor_hp" data-code="motor_hp">Motor Rated Power <span class="symbol" aria-hidden="true" data-latex="P_{m}">P<sub>m</sub></span></label>
            </th>
            <td class="value"><input id="motor_hp" type="number" step="25" value="150"></td>
            <td class="units">hp</td>
          </tr>
          <tr>
            <th scope="row">
              <label class="param-label" for="motor_max_rpm" data-code="motor_max_rpm">Motor Maximum Speed <span class="symbol" aria-hidden="true" data-latex="\omega_{m,\max}">ω<sub>m,max</sub></span></label>
            </th>
            <td class="value"><input id="motor_max_rpm" type="number" step="100" value="1800"></td>
            <td class="units">rpm</td>
          </tr>
          <tr>
            <th scope="row">
              <label class="param-label" for="motor_tmax" data-code="motor_tmax">Motor Maximum Torque <span class="symbol" aria-hidden="true" data-latex="\tau_{m,\max}">τ<sub>m,max</sub></span></label>
            </th>
            <td class="value"><input id="motor_tmax" type="number" step="10" value="230"></td>
            <td class="units">N·m</td>
          </tr>
        </tbody>
      </table>
    </section>
    
    <section class="card" data-drive-scope="hydraulic" data-summary-card>
      <h2 class="section-title">Section 1.3: Hydraulic Inputs</h2>
      <div class="input-sections">
        <section class="input-section">
          <h3 class="input-section__title">Hydraulic Inputs</h3>
          <table class="worksheet">
            <thead>
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col" class="value">Input</th>
                <th scope="col" class="units">Units</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row">
                  <label class="param-label" for="h_emotor_eff" data-code="h_emotor_eff">Electro-hydro-mechanical Efficiency <span class="symbol" aria-hidden="true" data-latex="\eta_{eh}">η<sub>eh</sub></span></label>
                </th>
                <td class="value"><input id="h_emotor_eff" type="number" step="0.1" value="0.85"></td>
                <td class="units">–</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="hydraulic_motor_select" data-code="hydraulic_motor_select">Hydraulic Motor Part Number</label>
                </th>
                <td class="value">
                  <select id="hydraulic_motor_select">
                    <option value="">Custom (manual input)</option>
                  </select>
                </td>
                <td class="units">–</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="h_hmot_cc" data-code="h_hmot_cc">Hydraulic Motor Displacement <span class="symbol" aria-hidden="true" data-latex="q_{hm}">q<sub>hm</sub></span></label>
                </th>
                <td class="value"><input id="h_hmot_cc" type="number" step="1" value="55"></td>
                <td class="units">cc/rev</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="h_hmot_rpm_max" data-code="h_hmot_rpm_max">Hydraulic Motor Maximum Speed <span class="symbol" aria-hidden="true" data-latex="\omega_{hm,\max}">ω<sub>hm,max</sub></span></label>
                </th>
                <td class="value"><input id="h_hmot_rpm_max" type="number" step="100" value="3500"></td>
                <td class="units">rpm</td>
              </tr>
            </tbody>
          </table>
        </section>
    
        <section class="input-section">
          <h3 class="input-section__title">HPU</h3>
          <table class="worksheet">
            <thead>
              <tr>
                <th scope="col">Parameter</th>
                <th scope="col" class="value">Input</th>
                <th scope="col" class="units">Units</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <th scope="row">
                  <label class="param-label" for="hpu_select" data-code="hpu_select">HPU Part Number</label>
                </th>
                <td class="value">
                  <select id="hpu_select">
                    <option value="">Custom (manual input)</option>
                  </select>
                </td>
                <td class="units">–</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="h_pump_strings" data-code="h_pump_strings">Number of Pump Strings <span class="symbol" aria-hidden="true" data-latex="N_{p}">N<sub>p</sub></span></label>
                </th>
                <td class="value"><input id="h_pump_strings" type="number" step="1" value="2"></td>
                <td class="units">count</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="hpu_motor_select" data-code="hpu_motor_select">HPU Motor Part Number</label>
                </th>
                <td class="value">
                  <select id="hpu_motor_select">
                    <option value="">Custom (manual input)</option>
                  </select>
                </td>
                <td class="units">–</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="h_emotor_hp" data-code="h_emotor_hp">Electric Motor Nameplate Power per String <span class="symbol" aria-hidden="true" data-latex="P_{e,\mathrm{str}}">P<sub>e,str</sub></span></label>
                </th>
                <td class="value"><input id="h_emotor_hp" type="number" step="25" value="75"></td>
                <td class="units">hp</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="h_emotor_rpm" data-code="h_emotor_rpm">Electric Motor Speed <span class="symbol" aria-hidden="true" data-latex="\omega_{e}">ω<sub>e</sub></span></label>
                </th>
                <td class="value"><input id="h_emotor_rpm" type="number" step="100" value="1780"></td>
                <td class="units">rpm</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="hydraulic_pump_select" data-code="hydraulic_pump_select">Hydraulic Pump Part Number</label>
                </th>
                <td class="value">
                  <select id="hydraulic_pump_select">
                    <option value="">Custom (manual input)</option>
                  </select>
                </td>
                <td class="units">–</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="h_pump_cc" data-code="h_pump_cc">Pump Displacement <span class="symbol" aria-hidden="true" data-latex="q_{\mathrm{pump}}">q<sub>pump</sub></span></label>
                </th>
                <td class="value"><input id="h_pump_cc" type="number" step="10" value="210"></td>
                <td class="units">cc/rev</td>
              </tr>
              <tr>
                <th scope="row">
                  <label class="param-label" for="h_max_psi" data-code="h_max_psi">System Maximum Pressure <span class="symbol" aria-hidden="true" data-latex="P_{\max}">P<sub>max</sub></span></label>
                </th>
                <td class="value"><input id="h_max_psi" type="number" step="100" value="3500"></td>
                <td class="units">psi</td>
              </tr>
            </tbody>
          </table>
        </section>
      </div>
    </section>
      <div class="btnbar app-sidebar__footer-actions">
        <button id="export-all-presets-btn" type="button">Export All Presets</button>
      </div>
        </div>
    </aside>
    <div class="sheet">
      <header class="page-header">
        <img src="assets/winch-header%20140px.png" alt="TekMarines winch diagram" class="page-header__image" />
        <h1 class="page-title">Winch Analysis</h1>
      </header>
      <div class="app-content" id="page-top">
        <div id="err"></div>
        <div class="tab-bar">
          <nav class="tabs" aria-label="App sections">
            <a class="tab-btn" href="#panel-inputs">Section 1: Summary</a>
            <a class="tab-btn" href="#panel-performance">Section 2: Performance Plots</a>
            <a class="tab-btn" href="#panel-results">Section 3: Layer Tables</a>
            <a class="tab-btn" href="#panel-converter">Section 4: Unit Converter</a>
            <a class="tab-btn" href="#panel-instructions">Section 5: Instructions</a>
            <a class="tab-btn" href="#panel-sea-state">Sea State Explorer</a>
          </nav>
        </div>
      
        <div
          id="panel-inputs"
          class="panel"
        >
          <section class="card">
            <div class="card-header">
              <h2 class="section-title">Section 1: Summary</h2>
            </div>
            <div id="input-summary-intro" class="summary-intro"></div>
            <div id="input-summary" class="input-summary"></div>
          </section>
          <p class="section-back-to-top"><a href="#page-top">Back to top ↑</a></p>
        </div>
        <div class="pdf-page-break" aria-hidden="true"></div>
      
        <div
          id="panel-performance"
          class="panel panel--performance"
          aria-live="polite"
        >
      <section class="card card--performance card--performance-first wave-card">
        <div class="card-header">
          <h2 class="section-title">Section 2.1: Wave Contours</h2>
          <div class="card-header-actions"></div>
        </div>
        
        <div class="plot-pair">
          <div class="plot-panel plot-panel--compact plot-panel--performance">
            <div class="plot-panel__heading">
              <div>
                <div class="plot-title">Speed vs Period with Height Lines</div>
                <div class="dim">How to evaluate AHC performance envelope.  The x-axis indicates wave period, the y-axis indicates peak vertical speed, and the contour set traces peak-to-trough wave heights for sinusoidal motion. The colored horizontal layer lines mark each winch layer’s available speed. Therefore, x-value of the intersection of a layer line with a contour indicates the shortest wave period for which the vertical motion can be fully compensated.</div>
              </div>
              <button type="button" class="plot-settings-btn" data-plot-settings-target="plot-settings-wave-speed" aria-label="Open axis settings for speed vs period plot">⚙</button>
            </div>
            <div class="plot-panel__toggles" aria-label="Wave speed overlays">
              <label class="plot-panel__checkbox" title="Overlay representative Douglas sea-state bands">
                <input id="wave_speed_show_sea_states" type="checkbox">
                <span>Sea states</span>
              </label>
            </div>
            <div class="plotwrap">
              <svg id="wave_svg" width="1000" height="540" viewBox="0 0 1000 540"></svg>
            </div>
            <div class="legend legend--panel">
              <div class="legitem"><span class="swatch accent"></span><span>Layer speed</span></div>
              <div class="legitem"><span class="swatch sea-state"></span><span>Douglas sea-state bands (optional)</span></div>
            </div>
            <p class="dim">Interactive: move mouse for crosshairs, click to pin a point, right-click a pin to remove it, double-click to clear all pins.</p>
          </div>
          <div class="plot-panel plot-panel--compact plot-panel--performance">
            <div class="plot-panel__heading">
              <div>
                <div class="plot-title">Wave Height vs Period with Speed Lines</div>
                <div class="dim">Evaluates the AHC operating envelope with wave period on the x-axis and wave height on the y-axis. Iso-lines track the available winch speed for each layer. Therefore, the area below and to the right of a line represents wave conditions for which, on the indicated layer, the winch can fully compensate for wave motion.</div>
              </div>
              <button type="button" class="plot-settings-btn" data-plot-settings-target="plot-settings-wave-height" aria-label="Open axis settings for wave height vs period plot">⚙</button>
            </div>
            <div class="plot-panel__toggles" aria-label="Wave height overlays">
              <label class="plot-panel__checkbox" title="Overlay representative Douglas sea-state bands">
                <input id="wave_show_sea_states" type="checkbox">
                <span>Sea states</span>
              </label>
              <label class="plot-panel__checkbox" title="Show deep-water breaking limit curve">
                <input id="wave_show_breaking_limit" type="checkbox">
                <span>Breaking limit</span>
              </label>
              <label class="plot-panel__checkbox" title="Show Pierson–Moskowitz fully developed sea curve">
                <input id="wave_show_pm_curve" type="checkbox">
                <span>PM sea</span>
              </label>
              <label class="plot-panel__checkbox" title="Show JONSWAP sea-state approximation (γ≈3.3)">
                <input id="wave_show_jonswap_curve" type="checkbox">
                <span>JONSWAP</span>
              </label>
              <label class="plot-panel__checkbox" title="Show Sverdrup–Munk–Bretschneider (SMB) sea-state approximation">
                <input id="wave_show_smb_curve" type="checkbox">
                <span>SMB</span>
              </label>
            </div>
            <div class="plotwrap">
              <svg id="wave_svg_height" width="1000" height="540" viewBox="0 0 1000 540"></svg>
            </div>
            <div class="legend legend--panel">
              <div class="legitem"><span class="swatch gray"></span><span>Layer speed iso-line</span></div>
              <div class="legitem"><span class="swatch"></span><span>H = integer m</span></div>
              <div class="legitem"><span class="swatch dashed"></span><span>H = 0.5 m offsets</span></div>
              <div class="legitem"><span class="swatch sea-state"></span><span>Douglas sea-state bands (optional)</span></div>
              <div class="legitem"><span class="swatch break-limit"></span><span>Breaking limit (optional)</span></div>
              <div class="legitem"><span class="swatch pm-curve"></span><span>PM fully developed sea (optional)</span></div>
              <div class="legitem"><span class="swatch jonswap-curve"></span><span>JONSWAP sea (optional)</span></div>
              <div class="legitem"><span class="swatch smb-curve"></span><span>SMB sea (optional)</span></div>
            </div>
            <p class="dim">Interactive: move mouse for crosshairs, click to pin a point, right-click a pin to remove it, double-click to clear all pins.</p>
          </div>
        </div>
      </section>

      <section class="card card--performance">
        <div class="card-header">
          <h2 class="section-title">Section 2.2: Depth Profiles</h2>
          <div class="card-header-actions"></div>
        </div>
        
        <div class="plot-pair">
          <div class="plot-panel plot-panel--compact plot-panel--performance">
            <div class="plot-panel__heading">
              <div>
                <div class="plot-title">Available Speed vs Depth</div>
              </div>
              <button type="button" class="plot-settings-btn" data-plot-settings-target="plot-settings-depth-speed" aria-label="Open axis settings for speed vs depth plot">⚙</button>
            </div>
            <div class="plotwrap">
              <svg id="depth_speed_svg" viewBox="0 0 1000 540"></svg>
            </div>
            <div class="legend legend--compact legend--panel">
              <div class="legitem"><span class="swatch accent"></span><span>Available speed</span></div>
              <div class="legitem"><span class="swatch rated"></span><span>Rated speed</span></div>
              <div class="legitem">
                <span class="swatch-group" aria-hidden="true">
                  <span class="swatch flow"></span>
                  <span class="swatch power"></span>
                </span>
                <span>
                  Candidate speeds (
                  <span data-latex="V_{p}">V<sub>p</sub></span>,
                  <span data-latex="V_{Q}">V<sub>Q</sub></span>
                  )
                </span>
              </div>
            </div>
            <p class="dim">Interactive: move mouse for crosshairs, click to pin a point, right-click a pin to remove it, double-click to clear all pins.</p>
          </div>
          <div class="plot-panel plot-panel--compact plot-panel--performance">
            <div class="plot-panel__heading">
              <div>
                <div class="plot-title">Tension vs Depth</div>
              </div>
              <button type="button" class="plot-settings-btn" data-plot-settings-target="plot-settings-depth-tension" aria-label="Open axis settings for tension vs depth plot">⚙</button>
            </div>
            <div class="plotwrap">
              <svg id="depth_tension_svg" viewBox="0 0 1000 540"></svg>
            </div>
            <div class="legend legend--compact legend--panel">
              <div class="legitem"><span class="swatch theoretical"></span><span>Required tension</span></div>
              <div class="legitem">
                <span class="swatch-group" aria-hidden="true">
                  <span class="swatch accent"></span>
                  <span class="swatch red"></span>
                </span>
                <span>Available tension (normal / exceeded)</span>
              </div>
            </div>
            <p class="dim">Interactive: move mouse for crosshairs, click to pin a point, right-click a pin to remove it, double-click to clear all pins.</p>
          </div>
        </div>
      </section>

      <section class="card card--performance" data-drive-scope="hydraulic">
        <div class="card-header">
          <h2 class="section-title">Section 2.3: Hydraulic RPM vs Torque</h2>
          <div class="card-header-actions"></div>
        </div>
        <div class="plot-pair">
          <div class="plot-panel plot-panel--compact plot-panel--performance">
            <div class="plot-panel__heading">
              <div>
                <div class="plot-title">Available RPM vs Torque</div>
                <div class="dim">Motor RPM per motor, evaluated at the start of each wrap. Available RPM is the lower of the flow-limited and power-limited RPM.</div>
              </div>
              <button type="button" class="plot-settings-btn" data-plot-settings-target="plot-settings-hyd-rpm" aria-label="Open axis settings for hydraulic RPM vs torque plot">⚙</button>
            </div>
            <div class="plotwrap">
              <svg id="hyd_rpm_torque_svg" viewBox="0 0 1000 540"></svg>
            </div>
            <div class="legend legend--compact legend--panel">
              <div class="legitem"><span class="swatch accent"></span><span>Available RPM</span></div>
              <div class="legitem"><span class="swatch flow"></span><span>Flow-limited RPM</span></div>
              <div class="legitem"><span class="swatch power"></span><span>Power-limited RPM</span></div>
            </div>
            <p class="dim">Interactive: move mouse for crosshairs, click to pin a point, right-click a pin to remove it, double-click to clear all pins.</p>
          </div>
        </div>
      </section>
      <p class="section-back-to-top"><a href="#page-top">Back to top ↑</a></p>
    </div>
    <div class="pdf-page-break" aria-hidden="true"></div>

    <div
      id="panel-sea-state"
      class="panel"
    >
      <section class="card sea-state-card">
        <div class="card-header">
          <h2 class="section-title">Hs vs Tp (Interactive)</h2>
        </div>
        <div class="sea-state-grid">
          <div class="sea-state-controls">
            <label><input id="sea-toggle-regions" type="checkbox" checked> Sea state regions (SS 3–7)</label>
            <label><input id="sea-toggle-grid" type="checkbox" checked> Grid</label>
            <label><input id="sea-toggle-snap" type="checkbox"> Snap 0.1 m / 0.1 s</label>
            <label><input id="sea-toggle-breaking" type="checkbox" checked> Breaking limit (deep-water steepness ≈ 1/7)</label>
            <label><input id="sea-toggle-pm" type="checkbox" checked> Pierson–Moskowitz fully developed sea</label>
            <button id="sea-clear-pins" type="button">Clear pinned</button>
          </div>
          <canvas id="sea-state-canvas" class="sea-state-canvas" width="1200" height="560" aria-label="Interactive Hs vs Tp chart"></canvas>
          <p class="dim sea-state-hint">
            Move mouse for crosshairs + tooltip + speed iso-line. Click to pin (persists). Right-click a pinned point to remove it.
            Tooltip speed is maximum vertical surface speed for a sinusoid: <span class="mono">v<sub>z,max</sub> = π·H/T</span> (using H = Hs).
          </p>
          <p class="dim sea-state-notes">
            (1) Douglas sea state is defined by <strong>Hs</strong> only; Tp bands are representative.
            (2) “Breaking limit” uses the deep-water steepness threshold <span class="mono">H/L ≈ 1/7</span> with <span class="mono">L = gT²/(2π)</span>.
            (3) PM “fully developed” line uses <span class="mono">Hs = 0.21·U10²/g</span> and <span class="mono">Tp = 7.54·U10/g</span>, so <span class="mono">Hs(Tp) = 0.21·g·Tp²/7.54²</span>.
          </p>
          <div class="legend legend--panel" id="sea-state-legend"></div>
          <h3 class="sea-state-pinned-title">Pinned points</h3>
          <table class="sea-state-table">
            <thead>
              <tr>
                <th>Label</th>
                <th>Tp (s)</th>
                <th>Hs (m)</th>
                <th>v<sub>z,max</sub> (m/s)</th>
                <th>v<sub>z,max</sub> (kn)</th>
              </tr>
            </thead>
            <tbody id="sea-pins-body"></tbody>
          </table>
        </div>
      </section>
      <p class="section-back-to-top"><a href="#page-top">Back to top ↑</a></p>
    </div>

    <div
      id="panel-results"
      class="panel"
      aria-live="polite"
    >
      <div class="card" id="drum_card">
        <div class="card-header">
          <h2 class="section-title">Section 3.1: Spooling Profile</h2>
          <div class="card-header-actions"></div>
        </div>
        <div class="drum-visual">
          <svg
            id="drum_visual_svg"
            class="drum-visual__svg"
            viewBox="0 0 320 320"
            role="img"
            aria-labelledby="drum_visual_title"
          >
            <title id="drum_visual_title">Winch drum cross-section</title>
          </svg>
                    <div id="drum_legend" class="legend legend--drum" hidden></div>
        </div>
        <p class="drum-summary" id="drum_summary"></p>
      </div>

      <div class="card" data-drive-scope="electric">
        <div class="section-title">Section 3.2: Electric Layer Table</div>
        <div class="btnbar">
          <button id="csv_el_layer" type="button" disabled>Download CSV — Electric Layer</button>
        </div>
        <table>
          <thead>
            <tr>
              <th title="layer_no">L#<br>(–)</th>
              <th title="layer_dia_in">
                <span data-latex="D_{layer}">D<sub>layer</sub></span><br>(in)
              </th>
              <th title="on_drum_range_m">Cable On Drum<br>(m)</th>
              <th title="depth_range_m">Depth Range<br>(m)</th>
              <th title="max_tension_required_kgf">
                <span data-latex="T_{req,\max}">T<sub>req,max</sub></span><br>(kgf)
              </th>
              <th title="tau_avail_kNm">
                <span data-latex="\tau_{avail}">τ<sub>avail</sub></span><br>(kN·m)
              </th>
              <th title="max_gearbox_torque_Nm">
                <span data-latex="\tau_{g}">τ<sub>g</sub></span><br>(N·m)
              </th>
              <th title="max_motor_torque_Nm">
                <span data-latex="\tau_{m,\max}">τ<sub>m,max</sub></span><br>(N·m)
              </th>
              <th title="motor_rpm_at_start">
                <span data-latex="n_{m,\mathrm{start}}">n<sub>m,start</sub></span><br>(rpm)
              </th>
              <th title="line_speed_at_start_mpm">
                <span data-latex="v_{\mathrm{start}}">v<sub>start</sub></span><br>(m/min)
              </th>
              <th title="tension_required_start_kgf">
                <span data-latex="T_{req}">T<sub>req</sub></span><br>(kgf)
              </th>
              <th title="avail_tension_kgf">
                <span data-latex="T_{avail}">T<sub>avail</sub></span><br>(kgf)
              </th>
            </tr>
          </thead>
          <tbody id="tbody_el_layer"></tbody>
        </table>
      </div>

      <details class="card collapsible" data-drive-scope="electric">
        <summary class="collapsible-summary">
          <span class="section-title">Section 3.3: Electric Wraps Table</span>
          <span
            class="collapsible-hint"
            aria-hidden="true"
            data-collapsible-open-label="hide wrap table [-]"
            data-collapsible-closed-label="view wrap table [+]"
          ></span>
        </summary>
        <div class="collapsible-body">
          <div class="btnbar">
            <button id="csv_el_wraps" type="button" disabled>Download CSV — Electric Wraps</button>
          </div>
          <table>
            <thead>
              <tr>
                <th title="wrap_no">W#<br>(–)</th>
                <th title="layer_no">L#<br>(–)</th>
                <th title="layer_dia_in">
                  <span data-latex="D_{layer}">D<sub>layer</sub></span><br>(in)
                </th>
                <th title="wrap_len_in">
                  <span data-latex="L_{wrap}">L<sub>wrap</sub></span><br>(in)
                </th>
                <th title="pre_spooled_len_m">pre_spool<br>(m)</th>
                <th title="spooled_len_m">on_drum<br>(m)</th>
                <th title="deployed_len_m">dep<br>(m)</th>
                <th title="tension_required_kgf">
                  <span data-latex="T_{req}">T<sub>req</sub></span><br>(kgf)
                </th>
                <th title="tau_avail_kNm">
                  <span data-latex="\tau_{avail}">τ<sub>avail</sub></span><br>(kN·m)
                </th>
                <th title="gearbox_torque_Nm">
                  <span data-latex="\tau_{g}">τ<sub>g</sub></span><br>(N·m)
                </th>
                <th title="motor_torque_Nm">
                  <span data-latex="\tau_{m}">τ<sub>m</sub></span><br>(N·m)
                </th>
                <th title="motor_rpm">
                  <span data-latex="n_{m}">n<sub>m</sub></span><br>(rpm)
                </th>
                <th title="line_speed_mpm">
                  <span data-latex="v">v</span><br>(m/min)
                </th>
                <th title="avail_tension_kgf">
                  <span data-latex="T_{avail}">T<sub>avail</sub></span><br>(kgf)
                </th>
              </tr>
            </thead>
            <tbody id="tbody_el_wraps"></tbody>
          </table>
        </div>
      </details>

      <div class="card" data-drive-scope="hydraulic">
        <div class="section-title">Section 3.4: Hydraulic Layer Table</div>
        <div class="btnbar">
          <button id="csv_hy_layer" type="button" disabled>Download CSV — Hydraulic Layer</button>
        </div>
        <table>
          <thead>
            <tr>
              <th title="layer_no">L#<br>(–)</th>
              <th title="layer_dia_in">
                <span data-latex="D_{layer}">D<sub>layer</sub></span><br>(in)
              </th>
              <th title="on_drum_range_m">Cable On Drum<br>(m)</th>
              <th title="depth_range_m">Depth Range<br>(m)</th>
              <th title="hyd_P_required_psi">
                <span data-latex="P_{req}">P<sub>req</sub></span><br>(psi)
              </th>
              <th title="hyd_speed_power_mpm">
                <span data-latex="v_{P}">v<sub>P</sub></span><br>(m/min)
              </th>
              <th title="hyd_speed_flow_mpm">
                <span data-latex="v_{Q}">v<sub>Q</sub></span><br>(m/min)
              </th>
              <th title="hyd_speed_available_mpm">
                <span data-latex="v_{avail}">v<sub>avail</sub></span><br>(m/min)
              </th>
              <th title="hyd_hp_req">
                <span data-latex="hp_{req}">hp<sub>req</sub></span><br>(hp)
              </th>
              <th title="hyd_hp_sys">
                <span data-latex="hp_{sys}">hp<sub>sys</sub></span><br>(hp)
              </th>
              <th title="hyd_tau_avail_kNm">
                <span data-latex="\tau_{avail}">τ<sub>avail</sub></span><br>(kN·m)
              </th>
              <th title="max_gearbox_torque_Nm">
                <span data-latex="\tau_{g}">τ<sub>g</sub></span><br>(N·m)
              </th>
              <th title="hyd_tension_required_start_kgf">
                <span data-latex="T_{req}">T<sub>req</sub></span><br>(kgf)
              </th>
              <th title="hyd_avail_tension_kgf">
                <span data-latex="T_{avail}">T<sub>avail</sub></span><br>(kgf)
              </th>
            </tr>
          </thead>
          <tbody id="tbody_hy_layer"></tbody>
        </table>
      </div>

      <details class="card collapsible" data-drive-scope="hydraulic">
        <summary class="collapsible-summary">
          <span class="section-title">Section 3.5: Hydraulic Wraps Table</span>
          <span
            class="collapsible-hint"
            aria-hidden="true"
            data-collapsible-open-label="hide wrap table [-]"
            data-collapsible-closed-label="view wrap table [+]"
          ></span>
        </summary>
        <div class="collapsible-body">
          <div class="btnbar">
            <button id="csv_hy_wraps" type="button" disabled>Download CSV — Hydraulic Wraps</button>
          </div>
          <table>
            <thead>
              <tr>
                <th title="wrap_no">W#<br>(–)</th>
                <th title="layer_no">L#<br>(–)</th>
                <th title="layer_dia_in">
                  <span data-latex="D_{layer}">D<sub>layer</sub></span><br>(in)
                </th>
                <th title="wrap_len_in">
                  <span data-latex="L_{wrap}">L<sub>wrap</sub></span><br>(in)
                </th>
                <th title="pre_spooled_len_m">pre_spool<br>(m)</th>
                <th title="spooled_len_m">on_drum<br>(m)</th>
                <th title="deployed_len_m">dep<br>(m)</th>
                <th title="tension_required_kgf">
                  <span data-latex="T_{req}">T<sub>req</sub></span><br>(kgf)
                </th>
                <th title="hyd_P_required_psi">
                  <span data-latex="P_{req}">P<sub>req</sub></span><br>(psi)
                </th>
                <th title="hyd_speed_power_mpm">
                  <span data-latex="v_{P}">v<sub>P</sub></span><br>(m/min)
                </th>
                <th title="hyd_speed_flow_mpm">
                  <span data-latex="v_{Q}">v<sub>Q</sub></span><br>(m/min)
                </th>
                <th title="hyd_speed_available_mpm">
                  <span data-latex="v_{avail}">v<sub>avail</sub></span><br>(m/min)
                </th>
                <th title="hyd_hp_req">
                  <span data-latex="hp_{req}">hp<sub>req</sub></span><br>(hp)
                </th>
                <th title="hyd_hp_sys">
                  <span data-latex="hp_{sys}">hp<sub>sys</sub></span><br>(hp)
                </th>
                <th title="hyd_tau_avail_kNm">
                  <span data-latex="\tau_{avail}">τ<sub>avail</sub></span><br>(kN·m)
                </th>
                <th title="gearbox_torque_Nm">
                  <span data-latex="\tau_{g}">τ<sub>g</sub></span><br>(N·m)
                </th>
                <th title="hyd_avail_tension_kgf">
                  <span data-latex="T_{avail}">T<sub>avail</sub></span><br>(kgf)
                </th>
              </tr>
            </thead>
            <tbody id="tbody_hy_wraps"></tbody>
          </table>
        </div>
      </details>
      <p class="section-back-to-top"><a href="#page-top">Back to top ↑</a></p>
    </div>
    <div class="pdf-page-break" aria-hidden="true"></div>

    <div
      id="panel-converter"
      class="panel"
    >
      <section class="card info-card unit-converter-card" aria-labelledby="unit-converter-title">
        <h2 class="section-title" id="unit-converter-title">Section 4: Unit Converter &amp; Quick Calculators</h2>
        <p class="dim">Convert engineering units and estimate immersed weight and power.</p>

        <h3>Unit converter</h3>
        <div class="unit-converter" id="unit-converter">
          <div class="unit-converter__inline" role="group" aria-label="Unit conversion">
            <select id="unit-converter-category" aria-label="Unit category"></select>
            <input id="unit-converter-input-value" type="number" step="any" value="1" inputmode="decimal" aria-label="Input value" />
            <select id="unit-converter-input-unit"></select>
            <span class="unit-converter__arrow" aria-hidden="true">→</span>
            <output id="unit-converter-output-value" aria-live="polite">—</output>
            <select id="unit-converter-output-unit"></select>
          </div>
        </div>

        <h3>Weight in air → weight in water</h3>
        <div class="unit-calculator-grid" role="group" aria-label="Weight in air to weight in water calculator">
          <input id="air-water-air-value" type="number" step="any" value="1000" aria-label="Weight in air" />
          <select id="air-water-air-unit" aria-label="Weight in air unit"></select>
          <input id="air-water-sg" type="number" step="any" value="7.85" aria-label="Material specific gravity" />
          <label for="air-water-sg" class="dim">Material SG</label>
          <input id="air-water-fluid-density" type="number" step="any" value="1025" aria-label="Fluid density in kg per cubic meter" />
          <label for="air-water-fluid-density" class="dim">Fluid density (kg/m³)</label>
          <output id="air-water-output" aria-live="polite">—</output>
          <select id="air-water-output-unit" aria-label="Weight in water output unit"></select>
        </div>

        <h3>Power = Force × Speed × Efficiency</h3>
        <div class="unit-calculator-grid" role="group" aria-label="Mechanical power calculator">
          <input id="mech-power-force-value" type="number" step="any" value="1000" aria-label="Force" />
          <select id="mech-power-force-unit" aria-label="Force unit"></select>
          <input id="mech-power-speed-value" type="number" step="any" value="1" aria-label="Speed" />
          <select id="mech-power-speed-unit" aria-label="Speed unit"></select>
          <input id="mech-power-efficiency" type="number" step="any" value="0.9" aria-label="Efficiency" />
          <label for="mech-power-efficiency" class="dim">Efficiency (0-1 or %)</label>
          <output id="mech-power-output" aria-live="polite">—</output>
          <select id="mech-power-output-unit" aria-label="Power output unit"></select>
        </div>

        <h3>Power = Pressure × Flow × Efficiency</h3>
        <div class="unit-calculator-grid" role="group" aria-label="Hydraulic power calculator">
          <input id="hyd-power-pressure-value" type="number" step="any" value="3000" aria-label="Pressure" />
          <select id="hyd-power-pressure-unit" aria-label="Pressure unit"></select>
          <input id="hyd-power-flow-value" type="number" step="any" value="60" aria-label="Flow" />
          <select id="hyd-power-flow-unit" aria-label="Flow unit"></select>
          <input id="hyd-power-efficiency" type="number" step="any" value="0.9" aria-label="Efficiency" />
          <label for="hyd-power-efficiency" class="dim">Efficiency (0-1 or %)</label>
          <output id="hyd-power-output" aria-live="polite">—</output>
          <select id="hyd-power-output-unit" aria-label="Power output unit"></select>
        </div>
      </section>
      <p class="section-back-to-top"><a href="#page-top">Back to top ↑</a></p>
    </div>
    <div class="pdf-page-break" aria-hidden="true"></div>

    <div
      id="panel-instructions"
      class="panel"
    >
      <section class="card info-card" id="preset-export-guide" aria-labelledby="preset-export-guide-title">
        <h2 class="section-title" id="preset-export-guide-title">Exporting component presets</h2>
        <p>
          Use the <strong>Export Preset</strong> option that now appears in every component selector to download the current
          field values as a JSON file. The downloaded file is now in <code>data/presets.json</code>-compatible array format,
          so it can replace that file directly or be merged with other exports.
        </p>
        <ol>
          <li>Select the component you want to export and adjust any inputs until they match the desired configuration.</li>
          <li>Choose <strong>Export Preset</strong> from the same dropdown. If no preset name or part number is available, you will be prompted to provide them.</li>
          <li>Save the downloaded file and either use it as <code>data/presets.json</code> directly (single-preset catalog) or merge its array entries with your existing preset catalog.</li>
          <li>Restart the analyzer server (or reload the page) so the new preset is picked up the next time selectors load.</li>
        </ol>
        <p>Each export shares a common shape:</p>
        <pre><code>[
  {
  "id": "uuid",
  "pn": "Human-friendly part number",
  "name": "Display name",
  "description": "Optional notes",
  "data": { /* component-specific values */ },
  "metadata": {
    "pn": "Matching part number",
    "type": "component type slug",
    "label": "UI label",
    "fieldMap": { "inputId": "dataKey" }
  },
  "createdAt": "2024-01-01T00:00:00.000Z",
  "updatedAt": "2024-01-01T00:00:00.000Z"
  }
]</code></pre>
        <p>Component-specific <code>data</code> keys and <code>fieldMap</code> entries include:</p>
        <ul>
          <li><strong>Cable</strong> — <code>data</code>: <code>c_mm</code>, <code>cable_len_m</code>, <code>depth_m</code>, <code>dead_m</code>, <code>c_w_kgpm</code>, <code>mbl_kgf</code>; <code>fieldMap</code> mirrors those keys.</li>
          <li><strong>Drum</strong> — <code>data</code>: <code>core_in</code>, <code>flange_dia_in</code>, <code>ftf_in</code>, <code>lebus_in</code>, <code>pack</code>, <code>wraps_override</code>.</li>
          <li><strong>Payload</strong> — <code>data</code>: <code>payload_kg</code>.</li>
          <li><strong>Gearbox</strong> — <code>data</code>: <code>gear_ratio_stage1</code>, <code>gear_ratio_stage2</code>, <code>gearbox_max_torque_Nm</code>.</li>
          <li><strong>Electric Motor</strong> — <code>data</code>: <code>motor_eff</code>, <code>motor_max_rpm</code>, <code>motor_hp</code>, <code>motor_tmax_Nm</code>.</li>
          <li><strong>HPU Motor</strong> — <code>data</code>: <code>h_emotor_hp</code>, <code>h_emotor_rpm</code>.</li>
          <li><strong>HPU</strong> — <code>data</code>: <code>h_pump_strings</code>, <code>h_emotor_hp</code>, <code>h_emotor_rpm</code>, <code>pump_disp_cc</code>, <code>hpu_motor_select</code>, <code>hydraulic_pump_select</code>.</li>
          <li><strong>Hydraulic Pump</strong> — <code>data</code>: <code>pump_disp_cc</code>, <code>pump_max_psi</code>.</li>
          <li><strong>Hydraulic Motor</strong> — <code>data</code>: <code>hyd_motor_disp_cc</code>, <code>hyd_motor_max_rpm</code>.</li>
          <li>
            <strong>System</strong> — <code>data</code> captures the joined configuration: <code>system_type_select</code>,
            <code>winch_type_select</code>, <code>cable_select</code>, <code>drum_select</code>, <code>payload_select</code>,
            <code>rated_swl_kgf</code>, <code>rated_speed_mpm</code>, <code>dead_m</code>, <code>depth_m</code>, <code>core_in</code>,
            <code>ftf_in</code>, <code>lebus_in</code>, <code>pack</code>, <code>wraps_override</code>, <code>motors</code>,
            <code>h_pump_strings</code>, <code>hpu_select</code>, <code>hpu_motor_select</code>, <code>gearbox_select</code>,
            <code>gear_ratio_stage1</code>, <code>gear_ratio_stage2</code>, <code>gearbox_max_torque_Nm</code>,
            <code>electric_motor_select</code>, <code>hydraulic_pump_select</code>, and <code>hydraulic_motor_select</code>.
          </li>
        </ul>
        <p>
          The timestamps are generated at export time and can be left as-is. If you maintain presets in source control, treat each exported file as a ready-made JSON array that is compatible with <code>data/presets.json</code>.
        </p>
        <p>
          Need to replace the server defaults in one step? Use the Export All Presets button in the Inputs sidebar to download every stored preset as a
          single <code>data/presets.json</code>-compatible file.
        </p>
        <p>
          <span class="dim">Use the Export All Presets button in the Inputs sidebar.</span>
        </p>
      </section>

      <section class="card info-card" id="hydraulic-core-equations" aria-labelledby="hydraulic-core-equations-title">
        <h2 class="section-title" id="hydraulic-core-equations-title">Hydraulic Winch System — Core Equations (Unitless Form)</h2>

        <h3>Symbols (reference units only)</h3>
        <div class="scrollable-table">
          <table>
            <thead>
              <tr>
                <th scope="col">Symbol</th>
                <th scope="col">Description</th>
                <th scope="col">Units</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="math" data-latex="n_{e}"></span></td>
                <td>electric motor speed</td>
                <td>rpm</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="D_{p}"></span></td>
                <td>pump displacement</td>
                <td>cc/rev</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="N_{p}"></span></td>
                <td>number of pumps</td>
                <td>–</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="\eta_{vp}"></span></td>
                <td>pump volumetric efficiency</td>
                <td>–</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="Q_{p,i}"></span></td>
                <td>actual per-pump flow</td>
                <td>cc/min</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="Q_{tot}"></span></td>
                <td>total manifold flow</td>
                <td>cc/min</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="N_{m}"></span></td>
                <td>number of motors in parallel</td>
                <td>–</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="D_{m}"></span></td>
                <td>motor displacement</td>
                <td>cc/rev</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="\eta_{vm}"></span></td>
                <td>motor volumetric efficiency</td>
                <td>–</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="n_{m}"></span></td>
                <td>motor speed</td>
                <td>rpm</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="n_{d}"></span></td>
                <td>drum (ring) speed</td>
                <td>rpm</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="G_{gb}"></span></td>
                <td>gearbox reduction</td>
                <td>–</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="G_{pr}"></span></td>
                <td>pinion&rarr;ring reduction</td>
                <td>–</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="G_{tot}"></span></td>
                <td>
                  total reduction =
                  <span class="math" data-latex="G_{gb} G_{pr}"></span>
                </td>
                <td>–</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="D_{\ell}(z)"></span></td>
                <td>
                  effective layer diameter at depth
                  <span class="math" data-latex="z"></span>
                </td>
                <td>m</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="v_{flow}(z)"></span></td>
                <td>flow-limited line speed</td>
                <td>m/s</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="P_{nom}"></span></td>
                <td>total nominal electric motor power</td>
                <td>kW</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="\eta_{em}"></span></td>
                <td>electromechanical efficiency</td>
                <td>–</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="P_{avail}"></span></td>
                <td>available electric motor power</td>
                <td>kW</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="T(z)"></span></td>
                <td>operating line tension</td>
                <td>N</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="v_{pwr}(z)"></span></td>
                <td>power-limited line speed</td>
                <td>m/s</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="v_{avail}(z)"></span></td>
                <td>available line speed</td>
                <td>m/s</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="W_{\mathrm{pay,sub}}"></span></td>
                <td>payload weight in water</td>
                <td>N</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="w_{c,\mathrm{sub}}"></span></td>
                <td>cable weight in water per unit length</td>
                <td>N/m</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="L"></span></td>
                <td>max usable cable length</td>
                <td>m</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="T_{\mathrm{static}}(z)"></span></td>
                <td>static line tension</td>
                <td>N</td>
              </tr>
              <tr>
                <td>
                  <span class="math" data-latex="\Delta T_a\!,\; \Delta T_d\!,\; \Delta T_h"></span>
                </td>
                <td>dynamic tension adders (accel, drag, heave)</td>
                <td>N</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="\tau_{m}"></span></td>
                <td>motor torque</td>
                <td>N·m</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="\eta_{train}"></span></td>
                <td>drivetrain efficiency</td>
                <td>–</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="\eta_{mm}"></span></td>
                <td>mechanical efficiency of motor</td>
                <td>–</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="r_{\ell}(z)"></span></td>
                <td>effective layer radius</td>
                <td>m</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="r_{core}"></span></td>
                <td>core radius</td>
                <td>m</td>
              </tr>
              <tr>
                <td><span class="math" data-latex="p_{c}"></span></td>
                <td>cable effective pitch (≈ cable dia × packing factor)</td>
                <td>m</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3>A) Available Line Speed — Unitless Relations</h3>
        <p>
          $$P_{\min} =
          \left(
            \dfrac{T_{\mathrm{SWL}}\, v_{\mathrm{rated}}}{\eta_{\mathrm{sys}}}
          \right)\, 1.2$$
        </p>
        <p>
          $$D_{\mathrm{layer}}(\ell)=D_{\mathrm{core}}+2t_{\mathrm{lebus}}+d_c+(\ell-1)d_c\,\phi_{\mathrm{pack}}$$
        </p>
        <p>Where:</p>
        <ul>
          <li><span class="math" data-latex="D_{\mathrm{core}}"></span> = core diameter</li>
          <li><span class="math" data-latex="t_{\mathrm{lebus}}"></span> = Lebus liner thickness</li>
          <li><span class="math" data-latex="d_c"></span> = cable diameter</li>
          <li><span class="math" data-latex="\phi_{\mathrm{pack}}"></span> = packing factor</li>
          <li><span class="math" data-latex="\ell"></span> = layer index</li>
        </ul>
        <ol>
          <li><p>$$Q_{p,i} = \eta_{vp}\, n_e\, D_p$$</p></li>
          <li><p>$$Q_{tot} = N_p\, Q_{p,i}$$</p></li>
          <li><p>$$Q_{m} = \dfrac{Q_{tot}}{N_{m}}$$</p></li>
          <li><p>$$n_{m} = \dfrac{\eta_{vm}\, Q_{m}}{D_{m}}$$</p></li>
          <li>
            <p>$$n_{d} = \dfrac{n_{m}}{G_{tot}}$$</p>
            <p>$$G_{tot} = G_{gb} \, G_{pr}$$</p>
          </li>
          <li>
            <p>
              $$v_{flow}(z) = \left( \frac{\pi \, D_{\ell}(z)}{60} \right) n_{d}$$
            </p>
          </li>
          <li><p>$$P_{avail} = \eta_{em}\, P_{nom}$$</p></li>
          <li><p>$$v_{pwr}(z) = \dfrac{P_{avail}}{T(z)}$$</p></li>
          <li>
            <p>
              $$v_{avail}(z) = \min\!\big(v_{flow}(z),\, v_{pwr}(z)\big)$$
            </p>
          </li>
        </ol>

        <!-- Equations -->
        <div class="equations">
          <p>
            $$v_{flow}(z) =
            \frac{\pi \, D_\ell(z)}{60}
            \left(
              \frac{
                \eta_{vm}
                \left(
                  \dfrac{N_p \, \eta_{vp} \, n_e \, D_p}{N_m}
                \right)
              }{
                D_m \, G_{gb} \, G_{pr}
              }
            \right)$$
          </p>

          <p>
            $$v_{pwr}(z) =
            \frac{\eta_{em} \, P_{nom}}{T(z)}$$
          </p>

          <p>
            $$v_{avail}(z) =
            \min\!\big(v_{flow}(z),\, v_{pwr}(z)\big)$$
          </p>
        </div>

        <h3>B) Tension vs Depth — Unitless Relations</h3>
        <ol start="10">
          <li>
            <p>
              $$T_{\mathrm{static}}(z) = W_{\mathrm{pay,sub}} + w_{c,\mathrm{sub}}\, z$$
            </p>
            <span class="note">
              for
              <span class="math" data-latex="0 \le z \le L"></span>
            </span>
          </li>
          <li>
            <p>
              $$T_{\mathrm{static}}(z) = W_{\mathrm{pay,sub}} + w_{c,\mathrm{sub}}\, L$$
            </p>
            <span class="note">
              for
              <span class="math" data-latex="z > L"></span>
            </span>
          </li>
          <li>
            <p>
              $$T(z) = T_{\mathrm{static}}(z) + \Delta T_a + \Delta T_d + \Delta T_h$$
            </p>
          </li>
          <li>
            <p>
              $$T(z) = T_{\mathrm{static}}(z) + \Delta T_a + \Delta T_d + \Delta T_h$$
            </p>
          </li>
        </ol>

        <h3>C) Cross-Checks (Optional)</h3>
        <ol start="14">
          <li>
            <p>
              $$T_{\mathrm{cap}}(z) = \dfrac{\tau_m N_m\, \eta_{\mathrm{train}}}{r_{\ell}(z)\, G_{tot}}$$
            </p>
          </li>
          <li>
            <p>
              $$\tau_m = \dfrac{\Delta p\, D_m\, \eta_{mm}}{2\pi}$$
            </p>
          </li>
          <li>
            <p>
              $$D_{\ell}(i) = 2 r_{\mathrm{core}} + 2 (i - 0.5) p_c$$
            </p>
          </li>
        </ol>

        <h3>D) Deployment Checks</h3>
        <p>
          Use these quick checks when validating simulation output against the normalized relations above.
        </p>
        <ul>
          <li>
            <p>
              $$T_{\mathrm{hoist}}(z) = T_{\mathrm{static}}(z) + \Delta T_a + \Delta T_d + \Delta T_h$$
            </p>
            consolidates the static and dynamic contributors into a single hoisting load profile.
          </li>
          <li>
            <p>
              $$P_{\mathrm{req}}(z) = T(z) \, v_{\mathrm{avail}}(z)$$
            </p>
            offers a spot-check on power demand at any depth when comparing to drive sizing limits.
          </li>
        </ul>

        <p>
          Each equation isolates the dependent quantity on the left-hand side for quick substitution while preserving unit-consistent implementation across measurement systems. All efficiencies, ratios, and reductions are dimensionless. Power-, flow-, and tension-limited speeds follow directly from these relationships.
        </p>
      </section>
      <section class="card info-card" id="component-catalog-card" aria-labelledby="component-catalog-instructions">
        <h2 class="section-title" id="component-catalog-instructions">How to update component presets</h2>
        <p>
          The component dropdowns now read from dedicated catalogs in
          <code>src/js/component-selectors.mjs</code>. Add or edit part numbers directly in the matching
          array to make them available across the app.
        </p>
        <ol>
          <li>
            Open <code>src/js/component-selectors.mjs</code> and locate the array that matches the component
            type you want to change (for example <code>GEARBOX_OPTIONS</code> or
            <code>ELECTRIC_MOTOR_OPTIONS</code>).
          </li>
          <li>
            Add a new object with the part number, description, and any field values that should autofill
            when the part is selected. Follow the existing entries as a template.
          </li>
          <li>
            Save the file and refresh the page. The new entry will appear under the corresponding dropdown
            and auto-populate the linked form inputs.
          </li>
        </ol>
        <p class="dim">
          Tip: if you need to clear a selection after experimenting, change any populated value and the app
          will revert the dropdown to <em>Custom (manual input)</em> automatically.
        </p>
        </section>
      </div>
      </div>
        <p class="section-back-to-top"><a href="#page-top">Back to top ↑</a></p>
    </div>

      <dialog id="plot-settings-wave-speed" class="plot-settings-dialog">
        <form method="dialog" class="plot-settings-dialog__card">
          <h3>Speed vs Period Axis Settings</h3>
          <label>Scenario<select id="wave_scenario"><option value="electric" selected>Electric</option><option value="hydraulic">Hydraulic</option></select></label>
          <label>Period Min (s)<input id="wave_tmin" type="number" step="0.1" min="0" value="4"></label>
          <label>Period Max (s)<input id="wave_tmax" type="number" step="0.1" min="0" value="20"></label>
          <label>Speed Min (m/s)<input id="wave_vmin" type="number" step="0.1" min="0" value="0"></label>
          <label>Speed Max (m/s)<input id="wave_vmax" type="number" step="0.1" min="0" placeholder="auto"></label>
          <menu>
            <button type="submit">Done</button>
          </menu>
        </form>
      </dialog>

      <dialog id="plot-settings-wave-height" class="plot-settings-dialog">
        <form method="dialog" class="plot-settings-dialog__card">
          <h3>Wave Height vs Period Axis Settings</h3>
          <label>Period Min (s)<input id="wave_tmin_height" type="number" step="0.1" min="0" value="4"></label>
          <label>Period Max (s)<input id="wave_tmax_height" type="number" step="0.1" min="0" value="20"></label>
          <label>Height Min (m)<input id="wave_hmin" type="number" step="0.1" min="0" value="0"></label>
          <label>Height Max (m)<input id="wave_hmax" type="number" step="0.1" min="0" value="6"></label>
          <menu>
            <button type="submit">Done</button>
          </menu>
        </form>
      </dialog>

      <dialog id="plot-settings-depth-speed" class="plot-settings-dialog">
        <form method="dialog" class="plot-settings-dialog__card">
          <h3>Depth Speed Axis Settings</h3>
          <label>Depth Min (m)<input id="depth_xmin" type="number" step="100" min="0" value="0"></label>
          <label>Depth Max (m)<input id="depth_xmax" type="number" step="100" min="0" placeholder="auto"></label>
          <label>Speed Min (m/s)<input id="depth_speed_ymin" type="number" step="0.5" min="0" value="0"></label>
          <label>Speed Max (m/s)<input id="depth_speed_ymax" type="number" step="0.5" min="0" placeholder="auto"></label>
          <menu>
            <button type="submit">Done</button>
          </menu>
        </form>
      </dialog>

      <dialog id="plot-settings-depth-tension" class="plot-settings-dialog">
        <form method="dialog" class="plot-settings-dialog__card">
          <h3>Depth Tension Axis Settings</h3>
          <label>Depth Min (m)<input id="depth_xmin_tension" type="number" step="100" min="0" value="0"></label>
          <label>Depth Max (m)<input id="depth_xmax_tension" type="number" step="100" min="0" placeholder="auto"></label>
          <label>Tension Min (kgf)<input id="depth_tension_ymin" type="number" step="100" min="0" value="0"></label>
          <label>Tension Max (kgf)<input id="depth_tension_ymax" type="number" step="100" min="0" placeholder="auto"></label>
          <menu>
            <button type="submit">Done</button>
          </menu>
        </form>
      </dialog>


      <dialog id="plot-settings-hyd-rpm" class="plot-settings-dialog">
        <form method="dialog" class="plot-settings-dialog__card">
          <h3>Hydraulic RPM vs Torque Axis Settings</h3>
          <label>Torque Min (N·m)<input id="hyd_torque_xmin" type="number" step="100" min="0" value="0"></label>
          <label>Torque Max (N·m)<input id="hyd_torque_xmax" type="number" step="100" min="0" placeholder="auto"></label>
          <label>RPM Min<input id="hyd_rpm_ymin" type="number" step="10" min="0" value="0"></label>
          <label>RPM Max<input id="hyd_rpm_ymax" type="number" step="10" min="0" placeholder="auto"></label>
          <menu>
            <button type="submit">Done</button>
          </menu>
        </form>
      </dialog>
      
      <script
        defer
        src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
        crossorigin="anonymous"
      ></script>
      <script>
        window.addEventListener('DOMContentLoaded', () => {
          if (!window.katex) {
            console.warn('KaTeX library not available, skipping math rendering.');
            return;
          }

          document.querySelectorAll('.math[data-latex]').forEach((el) => {
            const latex = el.dataset.latex;

            if (!latex) return;

            try {
              window.katex.render(latex, el, {
                throwOnError: false,
              });
              el.setAttribute('role', 'math');
              el.setAttribute('aria-label', latex);
            } catch (error) {
              console.error('KaTeX render failed for expression:', latex, error);
            }
          });
        });
      </script>
      
      <div class="sea-state-tooltip" id="sea-state-tooltip"></div>

      <div id="report-root" class="report-root" aria-hidden="true"></div>

      <!-- Main app script -->
      <script type="module" src="js/main.mjs"></script>
    </div>
  </div>
</body>
</html>
